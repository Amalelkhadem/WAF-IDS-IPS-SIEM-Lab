┌───────────────────────────────────────────────────────────────────────────────┐
│                                                                               │
│                            VirtualBox/Host Network                            │
│                                                                               │
│                                                                               │
│   +---------------------+                                                     │
│   |      Kali Linux     |                                                     │
│   |   (Attacker VM)     |                                                     │
│   +----------┬----------+                                                     │
│              │                                                                 │
│              │ Sends all HTTP/TCP requests (legitimate + malicious payloads)   │
│              │                                                                 │
│   +----------▼-------------------+                                             │
│   |      Ubuntu 24.04 Server    |                                             │
│   |  (Security Stack)           |                                             │
│   +------------------------------+                                             │
│   |                              |                                             │
│   |  +---------------------+     |                                             │
│   |  |      Suricata       |     |                                             │
│   |  |    (IDS/IPS)        |     |                                             │
│   |  |                     |     |                                             │
│   |  | - Analyzes network  |     |                                             │
│   |  |   traffic (TCP/IP)  |     |                                             │
│   |  | - Blocks:           |     |                                             │
│   |  |   • Port scans      |     |                                             │
│   |  |   • Exploits        |     |                                             │
│   |  |   • DDoS attempts   |     |                                             │
│   |  +----------┬----------+     |                                             │
│   |             │                |                                             │
│   |             ▼                |                                             │
│   |  +---------------------+     |                                             │
│   |  |    ModSecurity      |     |                                             │
│   |  |      (WAF)          |     |                                             │
│   |  |                     |     |                                             │
│   |  | - Analyzes HTTP/HTTPS|    |                                             │
│   |  | - Blocks:           |     |                                             │
│   |  |   • SQLi/XSS        |     |                                             │
│   |  |   • RCE/LFI         |     |                                             │
│   |  |   • Bruteforce      |     |                                             │
│   |  +----------┬----------+     |                                             │
│   |             │                |                                             │
│   |             ▼                |                                             │
│   |  +---------------------+     |                                             │
│   |  |   Apache + Web App  |     |                                             │
│   |  |  (Target Application)|   |                                             │
│   |  +---------------------+     |                                             │
│   |                              |                                             │
│   |  +---------------------+     |                                             │
│   |  |     Wazuh Agent     |     |                                             │
│   |  |   (SIEM Log Collector)◄───┤                                             │
│   |  +----------┬----------+     |                                             │
│   |             │                |                                             │
│   |  +----------▼----------+     |                                             │
│   |  | Security Logs       |     |                                             │
│   |  | (Suricata/ModSec)   |     |                                             │
│   |  +---------------------+     |                                             │
│   +------------------------------+                                             │
│                                                                               │
│   +---------------------+                                                     │
│   |    Windows Host     |                                                     │
│   |  (Wazuh Dashboard)  |                                                     │
│   |  http://IP:5601     ◄────────────────────────────────────────────────────┘
│   +---------------------+                                                     │
│                                                                               │
└───────────────────────────────────────────────────────────────────────────────┘